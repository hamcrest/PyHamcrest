- case: assert_that
  # pypy + mypy doesn't work. See https://foss.heptapod.net/pypy/pypy/-/issues/3526
  skip: platform.python_implementation() == "PyPy"
  main: |
    from hamcrest import assert_that, instance_of, starts_with

    assert_that("string", starts_with("str"))
    assert_that("str", instance_of(str))
    assert_that(99, starts_with("str"))
  out: |
    main:5: error: Cannot infer type argument 1 of "assert_that"  [misc]

- case: matcher_contravariance_issue_222
  # Issue 222: Matchers should be contravariant
  # https://github.com/hamcrest/PyHamcrest/issues/222
  # FIXED: Matcher is now contravariant
  skip: platform.python_implementation() == "PyPy"
  main: |
    from hamcrest import has_length, greater_than
    from hamcrest.core.matcher import Matcher

    # This now works: str is Sized, so Matcher[Sized] is assignable to Matcher[str]
    # because Matcher is contravariant
    matcher: Matcher[str] = has_length(greater_than(0))

- case: sequence_matcher_types_issue_234
  # Issue 234: Unexpected type warnings with sequence matchers
  # https://github.com/hamcrest/PyHamcrest/issues/234
  # NOTE: This issue appears to be resolved - no type errors are generated
  skip: platform.python_implementation() == "PyPy"
  main: |
    from hamcrest import assert_that, contains_exactly

    li = [1, 2, 3]
    ls = ['1', '2', '3']
    s = '123'

    # These should not produce type warnings (and they don't!)
    assert_that(li, contains_exactly(*li))
    assert_that(ls, contains_exactly(*ls))
    assert_that(ls, contains_exactly(*s))
    assert_that(s, contains_exactly(*s))
    assert_that(s, contains_exactly(*ls))
